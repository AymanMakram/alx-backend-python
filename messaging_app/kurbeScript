#!/bin/bash
# kurbeScript: Setup and verify a local Kubernetes cluster using Minikube

# Exit immediately if a command fails
set -e

# Function to check if Minikube is installed
check_minikube() {
    if ! command -v minikube &> /dev/null; then
        echo "âŒ Minikube is not installed. Please install Minikube first."
        exit 1
    else
        echo "âœ… Minikube is installed."
    fi
}

# Function to start the Kubernetes cluster
start_cluster() {
    echo "â³ Starting Minikube cluster..."
    minikube start
}

# Function to verify cluster info
verify_cluster() {
    echo "ðŸ” Verifying Kubernetes cluster..."
    kubectl cluster-info
}

# Function to retrieve available pods
list_pods() {
    echo "ðŸ“¦ Listing all pods in all namespaces..."
    kubectl get pods -A
}

# Main script execution
check_minikube

# Check if cluster is already running
if ! minikube status &> /dev/null; then
    start_cluster
else
    echo "âš¡ Minikube cluster is already running."
fi

verify_cluster
list_pods

echo "âœ… Kubernetes setup and verification completed successfully."
